2025-09-03 19:25:32,232 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.243:5000
2025-09-03 19:25:32,232 [INFO] [33mPress CTRL+C to quit[0m
2025-09-03 19:25:35,280 [ERROR] Exception on / [GET]
Traceback (most recent call last):
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\test c2\app.py", line 112, in index
    return render_template('index.html', agents=agents, tasks=tasks)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\templating.py", line 149, in render_template
    template = app.jinja_env.get_or_select_template(template_name_or_list)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 1087, in get_or_select_template
    return self.get_template(template_name_or_list, parent, globals)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 1016, in get_template
    return self._load_template(name, globals)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 975, in _load_template
    template = self.loader.load(self, name, self.make_globals(globals))
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\loaders.py", line 138, in load
    code = environment.compile(source, name, filename)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 771, in compile
    self.handle_exception(source=source_hint)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\test c2\templates\index.html", line 29, in template
    <td class="p-2">{{ (agent[1] | fromjson).hostname }}</td>
    ^
jinja2.exceptions.TemplateAssertionError: No filter named 'fromjson'.
2025-09-03 19:25:35,362 [INFO] 192.168.1.243 - - [03/Sep/2025 19:25:35] "[35m[1mGET / HTTP/1.1[0m" 500 -
2025-09-03 19:25:35,533 [ERROR] Exception on / [GET]
Traceback (most recent call last):
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\test c2\app.py", line 112, in index
    return render_template('index.html', agents=agents, tasks=tasks)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\templating.py", line 149, in render_template
    template = app.jinja_env.get_or_select_template(template_name_or_list)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 1087, in get_or_select_template
    return self.get_template(template_name_or_list, parent, globals)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 1016, in get_template
    return self._load_template(name, globals)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 975, in _load_template
    template = self.loader.load(self, name, self.make_globals(globals))
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\loaders.py", line 138, in load
    code = environment.compile(source, name, filename)
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 771, in compile
    self.handle_exception(source=source_hint)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Trong\AppData\Local\Programs\Python\Python313\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\test c2\templates\index.html", line 29, in template
    <td class="p-2">{{ (agent[1] | fromjson).hostname }}</td>
    ^
jinja2.exceptions.TemplateAssertionError: No filter named 'fromjson'.
2025-09-03 19:25:35,545 [INFO] 192.168.1.243 - - [03/Sep/2025 19:25:35] "[35m[1mGET / HTTP/1.1[0m" 500 -
2025-09-03 19:25:35,620 [INFO] 192.168.1.243 - - [03/Sep/2025 19:25:35] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-09-03 19:27:34,203 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.243:5000
2025-09-03 19:27:34,204 [INFO] [33mPress CTRL+C to quit[0m
2025-09-03 19:28:12,594 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:28:12,594 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:12] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:28:15,330 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:28:15,330 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:15] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:28:19,224 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:28:19,233 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:19] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:28:19,500 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:19] "GET / HTTP/1.1" 200 -
2025-09-03 19:28:19,649 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:19] "GET / HTTP/1.1" 200 -
2025-09-03 19:28:34,553 [INFO] Task c1ece3bc-8389-489d-9695-3ec0c0d2a03a added for agent 342550187b7b9fd8a0ac06c6cfc10848c50dd4490b81666464b40f3a9fb9e8a8: shell
2025-09-03 19:28:34,555 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:34] "POST /api/add_task HTTP/1.1" 200 -
2025-09-03 19:28:35,780 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:35] "GET / HTTP/1.1" 200 -
2025-09-03 19:28:36,894 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:28:36,895 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:36] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:28:46,578 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:28:46,579 [INFO] 192.168.1.243 - - [03/Sep/2025 19:28:46] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:29:39,501 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:29:39,502 [INFO] 192.168.1.243 - - [03/Sep/2025 19:29:39] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:29:42,591 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:29:42,591 [INFO] 192.168.1.243 - - [03/Sep/2025 19:29:42] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:29:46,751 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:29:46,752 [INFO] 192.168.1.243 - - [03/Sep/2025 19:29:46] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:29:48,231 [INFO] 192.168.1.243 - - [03/Sep/2025 19:29:48] "GET / HTTP/1.1" 200 -
2025-09-03 19:29:52,828 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:29:52,829 [INFO] 192.168.1.243 - - [03/Sep/2025 19:29:52] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:29:55,430 [INFO] 192.168.1.243 - - [03/Sep/2025 19:29:55] "[31m[1mGET /api/checkin HTTP/1.1[0m" 405 -
2025-09-03 19:30:03,014 [ERROR] Decryption error for agent unknown: 
2025-09-03 19:30:03,014 [INFO] 192.168.1.243 - - [03/Sep/2025 19:30:03] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:30:28,557 [INFO] 192.168.1.243 - - [03/Sep/2025 19:30:28] "[31m[1mGET /api/checkin HTTP/1.1[0m" 405 -
2025-09-03 19:32:49,746 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.243:5000
2025-09-03 19:32:49,748 [INFO] [33mPress CTRL+C to quit[0m
2025-09-03 19:32:52,259 [INFO] 192.168.1.243 - - [03/Sep/2025 19:32:52] "GET / HTTP/1.1" 200 -
2025-09-03 19:33:03,203 [ERROR] Decryption error: 
2025-09-03 19:33:03,203 [INFO] 192.168.1.243 - - [03/Sep/2025 19:33:03] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:33:06,280 [ERROR] Decryption error: 
2025-09-03 19:33:06,281 [INFO] 192.168.1.243 - - [03/Sep/2025 19:33:06] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:33:11,960 [ERROR] Decryption error: 
2025-09-03 19:33:11,962 [INFO] 192.168.1.243 - - [03/Sep/2025 19:33:11] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:33:18,052 [ERROR] Decryption error: 
2025-09-03 19:33:18,052 [INFO] 192.168.1.243 - - [03/Sep/2025 19:33:18] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:33:28,436 [ERROR] Decryption error: 
2025-09-03 19:33:28,438 [INFO] 192.168.1.243 - - [03/Sep/2025 19:33:28] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:36:17,321 [ERROR] Decryption error: 
2025-09-03 19:36:17,322 [INFO] 192.168.1.243 - - [03/Sep/2025 19:36:17] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:36:20,329 [ERROR] Decryption error: 
2025-09-03 19:36:20,329 [INFO] 192.168.1.243 - - [03/Sep/2025 19:36:20] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:36:24,364 [ERROR] Decryption error: 
2025-09-03 19:36:24,365 [INFO] 192.168.1.243 - - [03/Sep/2025 19:36:24] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:36:30,452 [ERROR] Decryption error: 
2025-09-03 19:36:30,454 [INFO] 192.168.1.243 - - [03/Sep/2025 19:36:30] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:36:40,525 [ERROR] Decryption error: 
2025-09-03 19:36:40,526 [INFO] 192.168.1.243 - - [03/Sep/2025 19:36:40] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:39:26,000 [ERROR] Decryption error: 
2025-09-03 19:39:26,002 [INFO] 192.168.1.243 - - [03/Sep/2025 19:39:26] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:39:29,119 [ERROR] Decryption error: 
2025-09-03 19:39:29,119 [INFO] 192.168.1.243 - - [03/Sep/2025 19:39:29] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:39:33,321 [ERROR] Decryption error: 
2025-09-03 19:39:33,321 [INFO] 192.168.1.243 - - [03/Sep/2025 19:39:33] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:39:39,587 [ERROR] Decryption error: 
2025-09-03 19:39:39,588 [INFO] 192.168.1.243 - - [03/Sep/2025 19:39:39] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:39:50,143 [ERROR] Decryption error: 
2025-09-03 19:39:50,144 [INFO] 192.168.1.243 - - [03/Sep/2025 19:39:50] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:42:36,631 [ERROR] Decryption error: 
2025-09-03 19:42:36,631 [INFO] 192.168.1.243 - - [03/Sep/2025 19:42:36] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:42:39,761 [ERROR] Decryption error: 
2025-09-03 19:42:39,761 [INFO] 192.168.1.243 - - [03/Sep/2025 19:42:39] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:42:43,831 [ERROR] Decryption error: 
2025-09-03 19:42:43,832 [INFO] 192.168.1.243 - - [03/Sep/2025 19:42:43] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:42:49,932 [ERROR] Decryption error: 
2025-09-03 19:42:49,933 [INFO] 192.168.1.243 - - [03/Sep/2025 19:42:49] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:43:00,103 [ERROR] Decryption error: 
2025-09-03 19:43:00,103 [INFO] 192.168.1.243 - - [03/Sep/2025 19:43:00] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:45:44,320 [ERROR] Decryption error: 
2025-09-03 19:45:44,321 [INFO] 192.168.1.243 - - [03/Sep/2025 19:45:44] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:45:47,376 [ERROR] Decryption error: 
2025-09-03 19:45:47,377 [INFO] 192.168.1.243 - - [03/Sep/2025 19:45:47] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:45:51,725 [ERROR] Decryption error: 
2025-09-03 19:45:51,725 [INFO] 192.168.1.243 - - [03/Sep/2025 19:45:51] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:45:57,827 [ERROR] Decryption error: 
2025-09-03 19:45:57,828 [INFO] 192.168.1.243 - - [03/Sep/2025 19:45:57] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:46:08,011 [ERROR] Decryption error: 
2025-09-03 19:46:08,012 [INFO] 192.168.1.243 - - [03/Sep/2025 19:46:08] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:49:57,283 [ERROR] Decryption error: 
2025-09-03 19:49:57,283 [INFO] 192.168.1.243 - - [03/Sep/2025 19:49:57] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:50:00,302 [ERROR] Decryption error: 
2025-09-03 19:50:00,303 [INFO] 192.168.1.243 - - [03/Sep/2025 19:50:00] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:50:04,339 [ERROR] Decryption error: 
2025-09-03 19:50:04,339 [INFO] 192.168.1.243 - - [03/Sep/2025 19:50:04] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:50:10,418 [ERROR] Decryption error: 
2025-09-03 19:50:10,419 [INFO] 192.168.1.243 - - [03/Sep/2025 19:50:10] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:50:20,536 [ERROR] Decryption error: 
2025-09-03 19:50:20,537 [INFO] 192.168.1.243 - - [03/Sep/2025 19:50:20] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:53:17,908 [ERROR] Decryption error: 
2025-09-03 19:53:17,908 [INFO] 192.168.1.243 - - [03/Sep/2025 19:53:17] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:53:21,218 [ERROR] Decryption error: 
2025-09-03 19:53:21,219 [INFO] 192.168.1.243 - - [03/Sep/2025 19:53:21] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:53:25,313 [ERROR] Decryption error: 
2025-09-03 19:53:25,314 [INFO] 192.168.1.243 - - [03/Sep/2025 19:53:25] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:53:31,307 [ERROR] Decryption error: 
2025-09-03 19:53:31,309 [INFO] 192.168.1.243 - - [03/Sep/2025 19:53:31] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:53:41,335 [ERROR] Decryption error: 
2025-09-03 19:53:41,336 [INFO] 192.168.1.243 - - [03/Sep/2025 19:53:41] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:55:41,093 [INFO] [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.243:5000
2025-09-03 19:55:41,094 [INFO] [33mPress CTRL+C to quit[0m
2025-09-03 19:55:46,024 [INFO] 192.168.1.243 - - [03/Sep/2025 19:55:46] "GET / HTTP/1.1" 200 -
2025-09-03 19:55:48,394 [INFO] 192.168.1.243 - - [03/Sep/2025 19:55:48] "GET / HTTP/1.1" 200 -
2025-09-03 19:56:07,528 [ERROR] Decryption failed for all keys: 
2025-09-03 19:56:07,529 [INFO] 192.168.1.243 - - [03/Sep/2025 19:56:07] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
2025-09-03 19:56:10,641 [ERROR] Decryption failed for all keys: 
2025-09-03 19:56:10,642 [INFO] 192.168.1.243 - - [03/Sep/2025 19:56:10] "[31m[1mPOST /api/checkin HTTP/1.1[0m" 400 -
